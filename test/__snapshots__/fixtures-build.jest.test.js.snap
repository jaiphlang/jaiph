// Jest Snapshot v1, https://jestjs.io/docs/snapshot-testing

exports[`fixture build snapshots build output matches snapshot 1`] = `
{
  "files": [
    "bootstrap_project.sh",
    "main.sh",
    "tools/security.sh",
  ],
  "outputByFile": {
    "bootstrap_project.sh": "#!/usr/bin/env bash

set -euo pipefail
jaiph_stdlib_path="\${JAIPH_STDLIB:-$HOME/.local/bin/jaiph_stdlib.sh}"
if [[ ! -f "$jaiph_stdlib_path" ]]; then
  echo "jai: stdlib not found at $jaiph_stdlib_path (set JAIPH_STDLIB or reinstall jaiph)" >&2
  exit 1
fi
source "$jaiph_stdlib_path"
if [[ "$(jaiph__runtime_api)" != "1" ]]; then
  echo "jai: incompatible jaiph stdlib runtime (required api=1)" >&2
  exit 1
fi

bootstrap_project__workflow_nodejs__impl() {
  set -eo pipefail
  set +u
  echo "Sorry, I cannot setup nodejs yet"
  exit 1
}

bootstrap_project__workflow_nodejs() {
  jaiph__run_step bootstrap_project__workflow_nodejs bootstrap_project__workflow_nodejs__impl "$@"
}",
    "main.sh": "#!/usr/bin/env bash

set -euo pipefail
jaiph_stdlib_path="\${JAIPH_STDLIB:-$HOME/.local/bin/jaiph_stdlib.sh}"
if [[ ! -f "$jaiph_stdlib_path" ]]; then
  echo "jai: stdlib not found at $jaiph_stdlib_path (set JAIPH_STDLIB or reinstall jaiph)" >&2
  exit 1
fi
source "$jaiph_stdlib_path"
if [[ "$(jaiph__runtime_api)" != "1" ]]; then
  echo "jai: incompatible jaiph stdlib runtime (required api=1)" >&2
  exit 1
fi
source "$(dirname "\${BASH_SOURCE[0]}")/bootstrap_project.sh"
source "$(dirname "\${BASH_SOURCE[0]}")/tools/security.sh"

# Validates local build prerequisites.
main__rule_project_ready__impl() {
  set -eo pipefail
  set +u
  test -f "package.json"
  test -n "$NODE_ENV"
}

main__rule_project_ready() {
  jaiph__run_step main__rule_project_ready jaiph__execute_readonly main__rule_project_ready__impl "$@"
}

# Verifies the project compiles successfully.
main__rule_build_passes__impl() {
  set -eo pipefail
  set +u
  npm run build
}

main__rule_build_passes() {
  jaiph__run_step main__rule_build_passes jaiph__execute_readonly main__rule_build_passes__impl "$@"
}

# Orchestrates checks, prompt execution, and docs refresh.
# Arguments:
#   $1: Feature requirements passed to the prompt.
main__workflow_default__impl() {
  set -eo pipefail
  set +u
  if ! main__rule_project_ready; then
    bootstrap_project__workflow_nodejs
  fi
  jaiph__prompt "$@" <<__JAIPH_PROMPT_25__

    Build the application using best practices.
    Follow requirements: $1
  
__JAIPH_PROMPT_25__
  main__rule_build_passes
  tools__security__rule_scan_passes
  main__workflow_update_docs
}

main__workflow_default() {
  jaiph__run_step main__workflow_default main__workflow_default__impl "$@"
}

# Refreshes documentation after a successful build.
main__workflow_update_docs__impl() {
  set -eo pipefail
  set +u
  jaiph__prompt "$@" <<__JAIPH_PROMPT_38__
Update docs
__JAIPH_PROMPT_38__
}

main__workflow_update_docs() {
  jaiph__run_step main__workflow_update_docs main__workflow_update_docs__impl "$@"
}",
    "tools/security.sh": "#!/usr/bin/env bash

set -euo pipefail
jaiph_stdlib_path="\${JAIPH_STDLIB:-$HOME/.local/bin/jaiph_stdlib.sh}"
if [[ ! -f "$jaiph_stdlib_path" ]]; then
  echo "jai: stdlib not found at $jaiph_stdlib_path (set JAIPH_STDLIB or reinstall jaiph)" >&2
  exit 1
fi
source "$jaiph_stdlib_path"
if [[ "$(jaiph__runtime_api)" != "1" ]]; then
  echo "jai: incompatible jaiph stdlib runtime (required api=1)" >&2
  exit 1
fi

tools__security__rule_scan_passes__impl() {
  set -eo pipefail
  set +u
  echo "Security scan placeholder here"
}

tools__security__rule_scan_passes() {
  jaiph__run_step tools__security__rule_scan_passes jaiph__execute_readonly tools__security__rule_scan_passes__impl "$@"
}",
  },
}
`;
